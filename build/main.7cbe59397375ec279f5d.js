(()=>{"use strict";class e{constructor(e,t){this._form=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._errorClass=e.errorClass,this._buttonSubmit=this._form.querySelector(e.buttonSubmitSelector),this._buttonSubmitDisabledClass=e.buttonSubmitDisabledClass,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector))}_disableSubmit(e){e.preventDefault()}enabledValidationForm(){this._addInputListners(),this._form.addEventListener("submit",this._disableSubmit),this._form.addEventListener("input",(()=>{this.toggleButton()})),this.toggleButton()}_addInputListners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._handleFormInput(e)}))}))}checkValidation(){this._inputList.forEach((e=>{this._handleFormInput(e)}))}_handleFormInput(e){this._inputElement=e,this._inputElementId=this._inputElement.id,this._spanError=this._form.querySelector(`#${this._inputElementId}-error`),this._inputElement.validity.valid?(this._inputElement.classList.remove(this._errorClass),this._spanError.textContent=""):(this._inputElement.classList.add(this._errorClass),this._spanError.textContent=this._inputElement.validationMessage)}toggleButton(){this._isFormValid=this._form.checkValidity(),this._buttonSubmit.disabled=!this._isFormValid,this._buttonSubmit.classList.toggle(this._buttonSubmitDisabledClass,!this._isFormValid)}}class t{constructor(e,t,o){this._cardData=e,this._photoTemplate=t,this._handleOpenPopupPhoto=o}createCard(){return this._photoElement=this._photoTemplate.querySelector(".photo__element"),this._photoElementClone=this._photoElement.cloneNode(!0),this._cardPhoto=this._photoElementClone.querySelector(".photo__img"),this._cardPhoto.src=this._cardData.link,this._cardPhoto.alt=this._cardData.name,this._cardTitle=this._photoElementClone.querySelector(".photo__title"),this._cardTitle.textContent=this._cardData.name,this._photoDelete=this._photoElementClone.querySelector(".photo__delete"),this._photoLike=this._photoElementClone.querySelector(".photo__like"),this._addInputListners(),this._photoElementClone}_addInputListners(){this._cardPhoto.addEventListener("click",this._handleOpenPopupPhoto),this._photoDelete.addEventListener("click",(()=>{this._removeCard()})),this._photoLike.addEventListener("click",(()=>{this._cardLike()}))}_removeCard(){this._photoElementClone.remove()}_cardLike(){this._photoLike.classList.toggle("photo__like_active")}}const o=document.querySelector(".popup_type_profile"),s=document.querySelector(".profile__button-edit"),n=document.querySelector(".popup__input_type_name-profile"),i=document.querySelector(".popup__input_type_profession-profile"),r=document.querySelector(".profile__name"),p=document.querySelector(".profile__subname"),u=document.querySelector(".profile__button-add"),l=document.querySelector(".popup_type_place"),_=document.querySelector(".popup_type_photo"),a=(document.querySelector(".popup__img"),document.querySelector(".popup__name"),document.querySelector(".popup__form_type_place")),h=document.querySelector(".popup__form_type_profile"),c=document.querySelector("#photo-template").content,d=document.querySelector(".photo__container"),m={formSelector:".popup__form",inputSelector:".popup__input",errorClass:"form__input_error",buttonSubmitSelector:".popup__submit-btn",buttonSubmitDisabledClass:"popup__submit-btn_disabled"};class b{constructor(e){this._popup=e,this._btnClose=this._popup.querySelector(".btn-close")}openPopup(){this._popup.classList.add("popup_active")}closePopup(){this._deleteEventLesteners(),this._popup.classList.remove("popup_active")}_setEventLesteners(){this._popup.addEventListener("mousedown",this._listenerClickOverley),document.addEventListener("keydown",this._handlePopupCloseEsc),this._btnClose.addEventListener("click",(()=>{this.closePopup()}))}_deleteEventLesteners(){this._popup.removeEventListener("mousedown",this._listenerClickOverley),document.removeEventListener("keydown",this._handlePopupCloseEsc),this._btnClose.removeEventListener("click",(()=>{this.closePopup()}))}_listenerClickOverley=e=>{e.target===e.currentTarget&&this.closePopup()};_handlePopupCloseEsc=e=>{"Escape"===e.key&&this.closePopup()}}class v extends b{constructor(e){super(e),this._popupPhotoImg=this._popup.querySelector(".popup__img"),this._popupPhotoName=this._popup.querySelector(".popup__name")}openPopup(e){super._setEventLesteners(),super.openPopup(),this._popupPhotoImg.src=e.link,this._popupPhotoName.alt=e.name,this._popupPhotoName.textContent=e.name}}class y extends b{constructor(e,{submitForm:t}){super(e),this._popupForm=this._popup.querySelector(".popup__form"),this._submitForm=t,this._inputList=this._popupForm.querySelectorAll(".popup__input")}openPopup(){super.openPopup(),this._setEventLesteners()}_getInputValues(){return this._inputsData={},this._inputList.forEach((e=>{this._inputsData[e.name]=e.value})),this._inputsData}_setEventLesteners(){super._setEventLesteners(),this._popupForm.addEventListener("submit",this._eventSubmit)}_deleteEventLesteners(){super._deleteEventLesteners(),this._popupForm.removeEventListener("submit",this._eventSubmit)}_eventSubmit=e=>{e.preventDefault(),this._submitForm(this._getInputValues()),this.closePopup()};closePopup(){this._deleteEventLesteners(),super.closePopup(),this._popupForm.reset()}}const E=new e(m,a);E.enabledValidationForm();const f=new e(m,h);function S(e){new v(_).openPopup(e)}f.enabledValidationForm();const L=new class{constructor({items:e,renderer:t},o){this._renderedItems=e,this._renderer=t,this._container=o}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const o=new t(e,c,(()=>{S(e)}));L.addItem(o.createCard())}},d);L.renderItems();const k=new class{constructor(e,t){this._nameProfile=e,this._subNameProfile=t}getUserInfo(){return this._dataList={},this._dataList.name=this._nameProfile.textContent,this._dataList.profession=this._subNameProfile.textContent,this._dataList}setUserInfo(e){this._nameProfile.textContent=e.name,this._subNameProfile.textContent=e.profession}}(r,p),C=new y(o,{submitForm:e=>{k.setUserInfo(e)}});s.addEventListener("click",(()=>{n.value=k.getUserInfo().name,i.value=k.getUserInfo().profession,C.openPopup(),f.toggleButton(),f.checkValidation()}));const P=new y(l,{submitForm:e=>{const o=new t(e,c,{submitForm:e=>{S(e)}});L.addItem(o.createCard())}});u.addEventListener("click",(()=>{P.openPopup(),E.toggleButton(),E.checkValidation()}))})();